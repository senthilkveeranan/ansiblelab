

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <script type="text/javascript" src="https://www.redhat.com/dtm.js"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta class="swiftype" name="published_at" data-type="date" content="2019-03-26" /> 
  <meta class="swiftype" name="version" data-type="string" content="3.4.3">


  <!-- this ^ ^ is for the original publishing date only, never for minor pushes that aren't actual version bumps of the docs (this helps us keep our search rank weighting in swiftype, our search server, prioritized based on the dates of the releases themselves) -->

  <script>
  var url = window.location.href;
  if(url.indexOf("latest") == -1){
   var version = url.replace("http://docs.ansible.com/ansible-tower/","");
   version = version.substring(0,url.indexOf("/"));
   url = url.replace(version,"latest");
  }
  var canon = document.createElement('link');
  canon.rel = "canonical";
  canon.href = url;
  document.head.appendChild(canon);
  </script>

  <!-- Google Tag Manager Data Layer -->
  <script>
   dataLayer = [];
  </script>
  <!-- End Google Tag Manager Data Layer -->

  
  <title>15. Job Templates &mdash; Ansible Tower User Guide v3.4.3</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'Ansible Tower 3.4.3',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="jquery.js"></script>
      <script type="text/javascript" src="underscore.js"></script>
      <script type="text/javascript" src="doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="theme.min.css" type="text/css" />
    <script type="text/javascript" src="theme.js"></script>
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Ansible Tower User Guide v3.4.3" href="index.html"/>
        <link rel="next" title="16. Job Slicing" href="job_slices.html"/>
        <link rel="prev" title="14. Inventories" href="inventories.html"/> 

  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

  <style>
    .search-reset-start {
        color: #463E3F;
        float: right;
        position: relative;
        top: -25px;
        left: -10px;
        z-index: 10;
     }
     .search-reset-start:hover {
        cursor: pointer;
        color: #2980B9;
     }
     #search-box-id {
        padding-right: 25px;
     }
  </style>

  <!-- Google Code for Remarketing Tag
  <script type="text/javascript">
  /* <![CDATA[ */
  var google_conversion_id = 972577926;
  var google_custom_params = window.google_tag_params;
  var google_remarketing_only = true;
  /* ]]> */
  </script>
  <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
  </script>
  <noscript>
    <div style="display:inline;">
        <img height="1" width="1" style="border-style:none;" alt=""
              src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/972577926/?value=0&amp;guid=ON&amp;script=0"/>
    </div>
  </noscript>
  End of Google Code for Remarketing Tag -->

<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300'
      rel='stylesheet' type='text/css'>

  <script type='text/javascript'>
    var googletag = googletag || {};
    googletag.cmd = googletag.cmd || [];
    (function() {
      var gads = document.createElement('script');
      gads.async = true;
      gads.type = 'text/javascript';
      var useSSL = 'https:' == document.location.protocol;
      gads.src = (useSSL ? 'https:' : 'http:') +
        '//www.googletagservices.com/tag/js/gpt.js';
      var node = document.getElementsByTagName('script')[0];
      node.parentNode.insertBefore(gads, node);
    })();
  </script>

  <script type='text/javascript'>
    googletag.cmd.push(function() {
      googletag.defineSlot('/1171614047/towerleft', [300, 250], 'div-gpt-ad-1453398530439-0').addService(googletag.pubads());
      googletag.pubads().enableSingleRequest();
      googletag.enableServices();
    });
  </script>
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
<!-- End Google Tag Manager -->

  <div class="DocSite-globalNav ansibleNav">
        <ul>
            <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
            <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
            <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
            <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
            <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
        </ul>
    </div>

<a class="DocSite-nav" href="http://docs.ansible.com/">
  <img class="DocSiteNav-logo"
    src="logo_invert.png"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">
    Documentation
  </div>
</a> 




<div class="wy-grid-for-nav">

  
 <nav data-toggle="wy-nav-shift" class="wy-nav-side">
    <div style="background-color:#ff5850;height=80px;margin:'auto auto auto auto'">
        <a class="DocSiteProduct-header DocSiteProduct-header--tower"
            href="http://docs.ansible.com/ansible-tower/">
            <div class="DocSiteProduct-productName">
                <div class="DocSiteProduct-logoText">
                    ANSIBLE TOWER 
                    <div class="DocSiteProduct-CurrentVersion" align="right">
                      v3.4.3
                  </div>
                </div>
            </div>
        </a>
        

        <div class="DocSiteProduct-CheckVersionPara">
          Are you using the latest and greatest version of Ansible Tower? Find the <a class="DocSiteProduct-versionheader" href="http://docs.ansible.com/ansible-tower/">Ansible Tower documentation</a> set which best matches your version of Tower.
            </div>
    </div>
    <div class="wy-side-nav-search" style="background-color:#ff5850;height=80px;margin:'auto auto auto auto'">
      <!-- <a href="index.html" class="icon icon-home"> Ansible Tower User Guide</a> -->
      <!-- <form class="wy-form" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form> -->

<!-- 
<script>
  (function() {
    var cx = '004731659079655444432:zgjlf-tkhya';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script> -->

<!-- <gcse:searchresults-only></gcse:searchresults-only> -->

<!-- swiftype search script -->

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','Vcn_rXrPfye6ziaZJZRt','2.0.0');
</script>

<!-- <form id="search-form-id" action="">
  <input type="text" class="st-default-search-input" name="query" placeholder="Search Tower Docs" id="search-box-id" /> 
  <a class="search-reset-start" id="search-reset"><i class="fa fa-times"></i></a>
  <a class="search-reset-start" id="search-start"><i class="fa fa-search"></i></a> 
 </form> -->

          


<!-- <script type="text/javascript" src="http://www.google.com/cse/brand?form=search-form-id&inputbox=search-box-id"></script> -->

<!-- 
<script>
  function executeQuery() {
      var input = document.getElementById('search-box-id');
      var element = google.search.cse.element.getElement('searchresults-only0');
      element.resultsUrl = '/htmlout/search.html'
      if (input.value == '') {
          element.clearAllResults();
          $('#page-content, .rst-footer-buttons, #search-start').show();
          $('#search-results, #search-reset').hide();
      } else {
          $('#page-content, .rst-footer-buttons, #search-start').hide();
          $('#search-results, #search-reset').show();
          element.execute(input.value);
      }
      return false;
      }

  $('#search-reset').hide();

  $('#search-box-id').css('background-position', '1em center');

  $('#search-box-id').on('blur', function() {
    $('#search-box-id').css('background-position', '1em center');
  });

  $('#search-start').click(function(e) { executeQuery(); });
  $('#search-reset').click(function(e) { $('#search-box-id').val(''); executeQuery(); });

  $('#search-form-id').submit(function(e) {
      console.log('submitting!');
      executeQuery();
      e.preventDefault();
      });
</script>
-->
    </div>

      <div id="menu-id" class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Ansible Tower User Guide v3.4.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#real-time-playbook-output-and-exploration">1.1. Real-time Playbook Output and Exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#push-button-automation">1.2. &#8220;Push Button&#8221; Automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#enhanced-and-simplified-role-based-access-control-and-auditing">1.3. Enhanced and Simplified Role-Based Access Control and Auditing</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#cloud-autoscaling-flexibility">1.4. Cloud &amp; Autoscaling Flexibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#the-ideal-restful-api">1.5. The Ideal RESTful API</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#backup-and-restore">1.6. Backup and Restore</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#ansible-galaxy-integration">1.7. Ansible Galaxy Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#inventory-support-for-openstack">1.8. Inventory Support for OpenStack</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#remote-command-execution">1.9. Remote Command Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#system-tracking">1.10. System Tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#integrated-notifications">1.11. Integrated Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#satellite-and-cloudforms-integration">1.12. Satellite and CloudForms Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#run-time-job-customization">1.13. Run-time Job Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#red-hat-insights-integration">1.14. Red Hat Insights Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#enhanced-tower-user-interface">1.15. Enhanced Tower User Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#custom-virtual-environments">1.16. Custom Virtual Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#authentication-enhancements">1.17. Authentication Enhancements</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#cluster-management">1.18. Cluster Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#container-platform-support">1.19. Container Platform Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#workflow-enhancements">1.20. Workflow Enhancements</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#job-distribution">1.21. Job Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#support-for-deployment-in-a-fips-enabled-environment">1.22. Support for deployment in a FIPS-enabled environment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license-support.html">2. Tower Licensing, Updates, and Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="license-support.html#support">2.1. Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="license-support.html#trial-evaluation">2.2. Trial / Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="license-support.html#subscription-types">2.3. Subscription Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="license-support.html#node-counting-in-licenses">2.4. Node Counting in Licenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="license-support.html#license-features">2.5. License Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="license-support.html#tower-component-licenses">2.6. Tower Component Licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logging_in.html">3. Logging In</a></li>
<li class="toctree-l1"><a class="reference internal" href="import_license.html">4. Import a License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="import_license.html#adding-a-tower-license-manually">4.1. Adding a Tower License Manually</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="main_menu.html">5. The Tower User Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="main_menu.html#activity-streams">5.1. Activity Streams</a></li>
<li class="toctree-l2"><a class="reference internal" href="main_menu.html#views">5.2. Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="main_menu.html#resources-and-access">5.3. Resources and Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="main_menu.html#tower-administration-menu">5.4. Tower Administration Menu</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="search_sort.html">6. Search</a><ul>
<li class="toctree-l2"><a class="reference internal" href="search_sort.html#searching-tips">6.1. Searching Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="search_sort.html#sort">6.2. Sort</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="organizations.html">7. Organizations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="organizations.html#creating-a-new-organization">7.1. Creating a New Organization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="users.html">8. Users</a><ul>
<li class="toctree-l2"><a class="reference internal" href="users.html#create-a-user">8.1. Create a User</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html#user-types-quick-view">8.2. User Types - Quick View</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html#users-organizations">8.3. Users - Organizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html#users-teams">8.4. Users - Teams</a></li>
<li class="toctree-l2"><a class="reference internal" href="users.html#users-permissions">8.5. Users - Permissions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="teams.html">9. Teams</a><ul>
<li class="toctree-l2"><a class="reference internal" href="teams.html#create-a-team">9.1. Create a Team</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="credentials.html">10. Credentials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="credentials.html#understanding-how-credentials-work">10.1. Understanding How Credentials Work</a></li>
<li class="toctree-l2"><a class="reference internal" href="credentials.html#getting-started-with-credentials">10.2. Getting Started with Credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="credentials.html#add-a-new-credential">10.3. Add a New Credential</a></li>
<li class="toctree-l2"><a class="reference internal" href="credentials.html#credential-types">10.4. Credential Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="credential_types.html">11. Custom Credential Types</a><ul>
<li class="toctree-l2"><a class="reference internal" href="credential_types.html#backwards-compatible-api-considerations">11.1. Backwards-Compatible API Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="credential_types.html#getting-started-with-credential-types">11.2. Getting Started with Credential Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="credential_types.html#create-a-new-credential-type">11.3. Create a New Credential Type</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="applications_auth.html">12. Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="applications_auth.html#getting-started-with-applications">12.1. Getting Started with Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="applications_auth.html#create-a-new-application">12.2. Create a new application</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">13. Projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="projects.html#add-a-new-project">13.1. Add a new project</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#work-with-permissions">13.2. Work with Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#work-with-notifications">13.3. Work with Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#work-with-job-templates">13.4. Work with Job Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="projects.html#work-with-schedules">13.5. Work with Schedules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="inventories.html">14. Inventories</a><ul>
<li class="toctree-l2"><a class="reference internal" href="inventories.html#smart-inventories">14.1. Smart Inventories</a></li>
<li class="toctree-l2"><a class="reference internal" href="inventories.html#add-a-new-inventory">14.2. Add a new inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="inventories.html#running-ad-hoc-commands">14.3. Running Ad Hoc Commands</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="job_templates.html#">15. Job Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#create-a-job-template">15.1. Create a Job Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#add-permissions">15.2. Add Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#work-with-notifications">15.3. Work with Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#view-completed-jobs">15.4. View Completed Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#scheduling">15.5. Scheduling</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#surveys">15.6. Surveys</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#launch-a-job-template">15.7. Launch a Job Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#copy-a-job-template">15.8. Copy a Job Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#scan-job-templates">15.9. Scan Job Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#fact-caching">15.10. Fact Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#utilizing-cloud-credentials">15.11. Utilizing Cloud Credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#provisioning-callbacks">15.12. Provisioning Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_templates.html#extra-variables">15.13. Extra Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="job_slices.html">16. Job Slicing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="job_slices.html#job-slice-considerations">16.1. Job slice considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_slices.html#job-slice-execution-behavior">16.2. Job slice execution behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="job_slices.html#search-job-slices">16.3. Search job slices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="workflows.html">17. Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="workflows.html#workflow-scenarios-and-considerations">17.1. Workflow scenarios and considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html#extra-variables">17.2. Extra Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html#workflow-states">17.3. Workflow States</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html#role-based-access-controls">17.4. Role-Based Access Controls</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="workflow_templates.html">18. Workflow Job Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#create-a-workflow-template">18.1. Create a Workflow Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#work-with-permissions">18.2. Work with Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#work-with-notifications">18.3. Work with Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#view-completed-jobs">18.4. View Completed Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#work-with-schedules">18.5. Work with Schedules</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#surveys">18.6. Surveys</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#workflow-visualizer">18.7. Workflow Visualizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#launch-a-workflow-template">18.8. Launch a Workflow Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#copy-a-workflow-template">18.9. Copy a Workflow Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_templates.html#extra-variables">18.10. Extra Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="instance_groups.html">19. Instance Groups</a><ul>
<li class="toctree-l2"><a class="reference internal" href="instance_groups.html#create-an-instance-group">19.1. Create an instance group</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="jobs.html">20. Jobs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#job-details-inventory-sync">20.1. Job Details - Inventory Sync</a></li>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#job-details-scm">20.2. Job Details - SCM</a></li>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#job-details-playbook-run">20.3. Job Details - Playbook Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="jobs.html#at-capacity-determination-and-job-impact">20.4. Ansible Tower Capacity Determination and Job Impact</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="notifications.html">21. Notifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="notifications.html#notifier-hierarchy">21.1. Notifier Hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="notifications.html#workflow">21.2. Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="notifications.html#create-a-notification-template">21.3. Create a Notification Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="notifications.html#notification-types">21.4. Notification Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="notifications.html#configuring-the-towerhost-hostname">21.5. Configuring the <code class="docutils literal"><span class="pre">towerhost</span></code> hostname</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="insights.html">22. Setting up an Insights Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="insights.html#create-insights-credential">22.1. Create Insights Credential</a></li>
<li class="toctree-l2"><a class="reference internal" href="insights.html#create-an-insights-project">22.2. Create an Insights Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="insights.html#create-insights-inventory">22.3. Create Insights Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="insights.html#create-a-scan-project">22.4. Create a Scan Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="insights.html#create-a-scan-job-template">22.5. Create a Scan Job Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="insights.html#remediate-insights-inventory">22.6. Remediate Insights Inventory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="best_practices.html">23. Best Practices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="best_practices.html#use-source-control">23.1. Use Source Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="best_practices.html#ansible-file-and-directory-structure">23.2. Ansible file and directory structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="best_practices.html#use-dynamic-inventory-sources">23.3. Use Dynamic Inventory Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="best_practices.html#variable-management-for-inventory">23.4. Variable Management for Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="best_practices.html#autoscaling">23.5. Autoscaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="best_practices.html#larger-host-counts">23.6. Larger Host Counts</a></li>
<li class="toctree-l2"><a class="reference internal" href="best_practices.html#continuous-integration-continuous-deployment">23.7. Continuous integration / Continuous Deployment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="security.html">24. Security</a><ul>
<li class="toctree-l2"><a class="reference internal" href="security.html#playbook-access-and-information-sharing">24.1. Playbook Access and Information Sharing</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html#role-based-access-controls">24.2. Role-Based Access Controls</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html#function-of-roles-editing-and-creating">24.3. Function of roles: editing and creating</a></li>
</ul>
</li>
</ul>

        

<div class="DocSite-sideNav ansibleNav">
    <ul class="">
    <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
    <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
    <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
    <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
    <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
    </ul>
</div>

    <!-- changeable widget -->
    <div id="sideBanner">
    <br/>
    <a href="http://www.ansible.com/tower-docs-left?utm_source=docs">
<img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-tower-docs-left-rail.png" />
    </a>
</div>



      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="https://docs.ansible.com/">Ansible Tower User Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">

    <!--        <div class="DocSiteBanner">
                <a class="DocSiteBanner-imgWrapper"
                    href="http://www.ansible.com/tower-docs-top?utm_source=tower-docs">
                    <img src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-tower-docs-top-left.png">
                </a>
                <a class="DocSiteBanner-imgWrapper"
                    href="http://www.ansible.com/tower-docs-top?utm_source=tower-docs">
                    <img src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-tower-docs-top-right.png">
                </a>
            </div> -->

          <ul class="wy-breadcrumbs">
    <li><a href="http://docs.ansible.com/" <title>Ansible Docs Home</title></a>&raquo;</li>
    <li><a href="http://docs.ansible.com/ansible-tower/" <title>Ansible Tower Docs</title></a>&raquo;</li>
    <li><a href="index.html" <title> &mdash; Ansible Tower User Guide v3.4.3</title></a> &raquo;</li>
    <!--  <li><a href="">15. Job Templates</a></li> -->
</ul>
<hr/>

          <div id="page-content">
          
  <div class="section" id="job-templates">
<span id="ug-jobtemplates"></span><h1>15. Job Templates<a class="headerlink" href="job_templates.html#job-templates" title="Permalink to this headline">¶</a></h1>
<p id="index-0">A <a class="reference external" href="http://docs.ansible.com/ansible-tower/3.4.3/html/installandreference/glossary.html#term-job-template" title="(in Ansible Tower Installation and Reference Guide v3.4.3)"><span class="xref std std-term">job template</span></a> is a definition and set of parameters for running an Ansible job. Job templates are useful to execute the same job many times. Job templates also encourage the reuse of Ansible playbook content and collaboration between teams. While the REST API allows for the execution of jobs directly, Tower requires that you first create a job template.</p>
<p>The (<img alt="jt-icon" src="templates-icon.png" />) menu opens a list of the job templates that are currently available. The job template list is sorted alphabetically by name but you can search by various fields and attributes of the job template. The job template list also enables you to launch, copy, and remove a job template. Before deleting a job template, be sure it is not used in a workflow job template.</p>
<p><img alt="Job templates - home with example job template" src="job-templates-home-with-example-job-template.png" /></p>
<div class="admonition note" id="deletion-warning">
<p class="first admonition-title">Note</p>
<p>If deleting items that are used by other work items, a message opens listing the items are affected by the deletion and prompts you to confirm the deletion. Some screens will contain items that are invalid or previously deleted, so they will fail to run. Below is an example of such a message:</p>
<img alt="_images/warning-deletion-dependencies.png" class="last" src="warning-deletion-dependencies.png" />
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Job templates can be used to build a workflow template. Many parameters in a job template allow you to enable <strong>Prompt on Launch</strong> that can be modified at the workflow level, and do not affect the values assigned at the job template level. For instructions, see the <a class="reference internal" href="workflow_templates.html#ug-wf-editor"><span class="std std-ref">Workflow Visualizer</span></a> section.</p>
</div>
<div class="section" id="create-a-job-template">
<h2>15.1. Create a Job Template<a class="headerlink" href="job_templates.html#create-a-job-template" title="Permalink to this headline">¶</a></h2>
<p>To create a new job template:</p>
<ol class="arabic simple">
<li>Click the <img alt="add" src="add-button.png" /> button then select <strong>Job Template</strong> from the menu list.</li>
</ol>
<p><img alt="Job templates - create new job template" src="job-templates-create-new-job-template.png" /></p>
<ol class="arabic simple" start="2">
<li>Enter the appropriate details into the following fields:</li>
</ol>
<ul class="simple">
<li><strong>Name</strong>: Enter a name for the job.</li>
<li><strong>Description</strong>: Enter an arbitrary description as appropriate (optional).</li>
<li><strong>Job Type</strong>:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><strong>Run</strong>: Execute the playbook when launched, running Ansible tasks on the selected hosts.</li>
<li><strong>Check</strong>: Perform a &#8220;dry run&#8221; of the playbook and report changes that would be made without actually making them. Tasks that do not support check mode will be skipped and will not report potential changes.</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><strong>Prompt on Launch</strong> &#8211; If selected, even if a default value is supplied, you will be prompted upon launch to choose a job type of run or check.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">More information on job types can be found in the <a class="reference external" href="http://docs.ansible.com/playbooks_special_topics.html">Playbooks: Special Topics</a> section of the Ansible documentation.</p>
</div>
</div></blockquote>
<ul class="simple">
<li><strong>Inventory</strong>: Choose the inventory to be used with this job template from the inventories available to the currently logged in Tower user.</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied, you will be prompted upon launch to choose an inventory to run this job template against.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><strong>Project</strong>: Choose the project to be used with this job template from the projects available to the currently logged in Tower user.</li>
<li><strong>Playbook</strong>: Choose the playbook to be launched with this job template from the available playbooks. This menu is automatically populated with the names of the playbooks found in the project base path for the selected project. For example, a playbook named &#8220;jboss.yml&#8221; in the project path appears in the menu as &#8220;jboss&#8221;.</li>
<li><strong>Credential</strong>: Click the <img alt="search" src="search-button.png" /> button to open a separate window. Choose the credential from the available options to be used with this job template. Use the drop-down menu list to filter by credential type if the list is extensive.</li>
</ul>
<blockquote>
<div><img alt="_images/job-templates-credentials-selection-box.png" src="job-templates-credentials-selection-box.png" />
<ul>
<li><p class="first"><strong>Prompt on Launch</strong>: If selected, upon launching a job template that has a default machine credential, you will not be able to remove the default machine credential in the Prompt dialog without replacing it with another machine credential before it can launch. Alternatively, you can add more credentials as you see fit. Below is an example of such a message:</p>
<blockquote>
<div><img alt="_images/prompt-default-creds-missing.png" src="prompt-default-creds-missing.png" />
</div></blockquote>
</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><strong>Forks</strong>: The number of parallel or simultaneous processes to use while executing the playbook. A value of zero uses the Ansible default setting, which is 5 parallel processes unless overridden in <code class="docutils literal"><span class="pre">/etc/ansible/ansible.cfg</span></code>.</li>
<li><strong>Limit</strong>: A host pattern to further constrain the list of hosts managed or affected by the playbook. Multiple patterns can be separated by colons (&#8221;:&#8221;). As with core Ansible, &#8220;a:b&#8221; means &#8220;in group a or b&#8221;, &#8220;a:b:&amp;c&#8221; means &#8220;in a or b but must be in c&#8221;, and &#8220;a:!b&#8221; means &#8220;in a, and definitely not in b&#8221;.</li>
</ul>
<blockquote>
<div><ul>
<li><p class="first"><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied, you will be prompted upon launch to choose a limit.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For more information and examples refer to <a class="reference external" href="http://docs.ansible.com/intro_patterns.html">Patterns</a> in the Ansible documentation.</p>
</div>
</li>
</ul>
</div></blockquote>
<ul>
<li><p class="first"><strong>Verbosity</strong>: Control the level of output Ansible produces as the playbook executes. Set the verbosity to any of Default, Verbose, or Debug. This only appears in the &#8220;details&#8221; report view. Verbose logging includes the output of all commands. Debug logging is exceedingly verbose and includes information on SSH operations that can be useful in certain support instances. Most users do not need to see debug mode output.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Verbosity 5 causes Tower to block heavily when jobs are running, which could delay reporting that the job has finished (even though it has) and can cause the browser tab to lock up.</p>
</div>
</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied, you will be prompted upon launch to choose a verbosity.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><strong>Job Tags</strong>: Provide a comma-separated list of playbook tags to specify what parts of the playbooks should be executed. For more information and examples refer to <a class="reference external" href="http://docs.ansible.com/playbooks_tags.html">Tags</a> in the Ansible documentation.</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied, you will be prompted upon launch to choose a job tag.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><strong>Skip Tags</strong>: Provide a comma-separated list of playbook tags to skip certain tasks or parts of the playbooks to be executed. For more information and examples refer to <a class="reference external" href="http://docs.ansible.com/playbooks_tags.html">Tags</a> in the Ansible documentation.</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied, you will be prompted upon launch to choose tag(s) to skip.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><strong>Labels</strong>: Supply optional labels that describe this job template, such as &#8220;dev&#8221; or &#8220;test&#8221;. Labels can be used to group and filter job templates and completed jobs in the Tower display.</li>
</ul>
<blockquote>
<div><ul>
<li><p class="first">Labels are created when they are added to the Job Template. Labels are associated to a single Organization using the Project that is provided in the Job Template. Members of the Organization can create labels on a Job Template if they have edit permissions (such as admin role).</p>
</li>
<li><p class="first">Once the Job Template is saved, the labels appear in the Job Templates overview.</p>
</li>
<li><p class="first">Click on the &#8220;x&#8221; beside a label to remove it. When a label is removed, and is no longer associated with a Job or Job Template, the label is permanently deleted from the list of Organization labels.</p>
</li>
<li><p class="first">Jobs inherit labels from the Job Template at the time of launch. If a label is deleted from a Job Template, it is also deleted from the Job.</p>
<img alt="_images/job-template-create-labels.png" src="job-template-create-labels.png" />
<img alt="_images/job-template-saved-labels.png" src="job-template-saved-labels.png" />
</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><strong>Instance Groups</strong>: Click the <img alt="search" src="search-button.png" /> button to open a separate window. Choose the instance groups on which you want to run this job template. If the list is extensive, use the search to narrow the options.</li>
<li><strong>Job Slicing</strong>: Specify the number of slices you want this job template to run. Each slice will run the same tasks against a portion of the inventory. For more information about job slices, see <a class="reference internal" href="job_slices.html#ug-job-slice"><span class="std std-ref">Job Slicing</span></a>.</li>
<li><strong>Show Changes</strong>: Allows you to see the changes made by Ansible tasks.</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied, you will be prompted upon launch to choose whether or not to show changes.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><strong>Options</strong>: Supply optional labels that describe this job template, such as &#8220;dev&#8221; or &#8220;test&#8221;. Labels can be used to group and filter job templates and completed jobs in the Tower display.</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><strong>Enable Privilege Escalation</strong>: If enabled, run this playbook as an administrator. This is the equivalent of passing the <code class="docutils literal"><span class="pre">--become</span></code> option to the <code class="docutils literal"><span class="pre">ansible-playbook</span></code> command.</li>
<li><strong>Allow Provisioning Callbacks</strong>: Enable a host to call back to Tower via the Tower API and invoke the launch of a job from this job template. Refer to <a class="reference internal" href="job_templates.html#ug-provisioning-callbacks"><span class="std std-ref">Provisioning Callbacks</span></a> for additional information.</li>
<li><strong>Enable Concurrent Jobs</strong>: Allow jobs in the queue to run simultaneously if not dependent on one another. Check this box if you want to run job slices simultaneously. Refer to <a class="reference internal" href="jobs.html#ug-job-concurrency"><span class="std std-ref">Ansible Tower Capacity Determination and Job Impact</span></a> for additional information.</li>
<li><strong>Use Fact Cache</strong>: When enabled, Tower will activate an Ansible fact cache plugin for all hosts in an inventory related to the job running.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><strong>Extra Variables</strong>:</li>
</ul>
<blockquote>
<div><ul>
<li><p class="first">Pass extra command line variables to the playbook. This is the &#8220;-e&#8221; or &#8220;&#8211;extra-vars&#8221; command line parameter for ansible-playbook that is documented in the Ansible documentation at <a class="reference external" href="http://docs.ansible.com/playbooks_variables.html#passing-variables-on-the-command-line">Passing Variables on the Command Line</a>.</p>
</li>
<li><p class="first">Provide key/value pairs using either YAML or JSON. These variables have a maximum value of precedence and overrides other variables specified elsewhere. An example value might be:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git_branch</span><span class="p">:</span> <span class="n">production</span>
<span class="n">release_version</span><span class="p">:</span> <span class="mf">1.5</span>
</pre></div>
</div>
</li>
</ul>
<p>For more information about extra variables, refer to <a class="reference internal" href="job_templates.html#ug-jobtemplates-extravars"><span class="std std-ref">Extra Variables</span></a>.</p>
<ul class="simple">
<li><strong>Prompt on Launch</strong>: If selected, even if a default value is supplied, you will be prompted upon launch to choose command line variables.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you want to be able to specify <code class="docutils literal"><span class="pre">extra_vars</span></code> on a schedule, you must select <strong>Prompt on Launch</strong> for <strong>EXTRA VARIABLES</strong> on the job template, or a enable a survey on the job template, then those answered survey questions become <code class="docutils literal"><span class="pre">extra_vars</span></code>.</p>
</div>
<ol class="arabic simple" start="3">
<li>When you have completed configuring the details of the job template, select <strong>Save</strong>.</li>
</ol>
<p>Saving the template does not exit the job template page but remains on the Job Template Details view for further editing, if necessary. After saving the template, you can now proceed with adding more attributes about the template, such as permissions, notifications, view completed jobs, and add a survey (if the job type is not a scan).</p>
<img alt="_images/job-templates-job-template-saved.png" src="job-templates-job-template-saved.png" />
<p>You can verify the template is saved when the newly created template appears on the list of templates at the bottom of the screen.</p>
<img alt="_images/job-templates-home-with-example-job-template-add.png" src="job-templates-home-with-example-job-template-add.png" />
</div>
<div class="section" id="add-permissions">
<h2>15.2. Add Permissions<a class="headerlink" href="job_templates.html#add-permissions" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div></div></blockquote>
<p id="ug-permissions">The <strong>Permissions</strong> tab allows you to review, grant, edit, and remove associated permissions for users as well as team members. To assign permissions to a particular user for this resource:</p>
<ol class="arabic simple">
<li>Click the <strong>Permissions</strong> tab.</li>
<li>Click the <img alt="add" src="add-button.png" /> button to open the Add Users/Teams window.</li>
</ol>
<blockquote>
<div><img alt="Add Permissions Form" src="add-permissions-start.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Specify the users or teams that will have access then assign them specific roles:</li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li>Click to select one or multiple checkboxes beside the name(s) of the user(s) or team(s) to select them.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can select multiple users and teams at the same time by navigating between the <strong>Users</strong> and <strong>Teams</strong> tabs without saving.</p>
</div>
<p>After selections are made, the window expands to allow you to select a role from the drop-down menu list for each user or team you chose.</p>
<blockquote>
<div><img alt="Roles Assignment for Selected Users" src="add-permissions-roles.png" />
</div></blockquote>
<p>The example above shows options associated with inventories. Different resources have different options available:</p>
<ul class="simple">
<li><strong>Admin</strong> allows read, run, and edit privileges (applies to all resources)</li>
<li><strong>Use</strong> allows use of a resource in a job template (applies all resources except job templates)</li>
<li><strong>Update</strong> allows updating of project via the SCM Update (applies to projects and inventories)</li>
<li><strong>Ad Hoc</strong> allows use of Ad Hoc commands (applies to inventories)</li>
<li><strong>Execute</strong> allows launching of a job template (applies to job templates)</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Use the <strong>Key</strong> button in the roles selection pane to display a description of each of the roles.</p>
</div>
<ol class="loweralpha simple" start="2">
<li>Select the role to apply to the selected user or team.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<blockquote>
<div>You can assign roles to multiple users and teams by navigating between the <strong>Users</strong> and <strong>Teams</strong> tabs without saving.</div></blockquote>
<img alt="Add Permissions - Examples of users and teams selected" class="last" src="add-permissions-users-teams-selected.png" />
</div>
</div></blockquote>
<ol class="arabic simple" start="4">
<li>Review your role assignments for each user and team.</li>
</ol>
<img alt="Add Permissions - Examples of roles applied" src="add-permissions-roles-examples.png" />
<ol class="arabic" start="5">
<li><p class="first">Click <strong>Save</strong> when done, and the Add Users/Teams window closes to display the updated roles assigned for each user and team.</p>
<blockquote>
<div><img alt="Permissions tab with Role Assignments" src="permissions-tab-roles-assigned.png" />
</div></blockquote>
</li>
</ol>
<blockquote>
<div><p>To remove Permissions for a particular user, click the Disassociate (x) button next to its resource.</p>
<blockquote>
<div><img alt="_images/permissions-disassociate.png" src="permissions-disassociate.png" />
</div></blockquote>
<p>This launches a confirmation dialog, asking you to confirm the disassociation.</p>
<blockquote>
<div><img alt="_images/permissions-disassociate-confirm.png" src="permissions-disassociate-confirm.png" />
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="work-with-notifications">
<h2>15.3. Work with Notifications<a class="headerlink" href="job_templates.html#work-with-notifications" title="Permalink to this headline">¶</a></h2>
<p>Clicking the <strong>Notifications</strong> tab allows you to review any notification integrations you have setup. If none are setup, the following screen displays with links to create one:</p>
<img alt="_images/job-template-notifications-empty.png" src="job-template-notifications-empty.png" />
<p>Follow the on-screen links to create a notification template. Refer to <a class="reference internal" href="notifications.html#ug-notifications"><span class="std std-ref">Notifications</span></a> for more information.</p>
<img alt="_images/job-template-completed-notifications-view.png" src="job-template-completed-notifications-view.png" />
</div>
<div class="section" id="view-completed-jobs">
<h2>15.4. View Completed Jobs<a class="headerlink" href="job_templates.html#view-completed-jobs" title="Permalink to this headline">¶</a></h2>
<p>The <strong>Completed Jobs</strong> tab provides details of how this job template has been run. It provides you with the ID, Name, Job Type, when it completed, and allows you to relaunch or delete the job. You can filter the list of completed jobs using the job ID, Name, Type, or if the Job Failed.</p>
<img alt="_images/job-template-completed-jobs-view.png" src="job-template-completed-jobs-view.png" />
<p>Sliced jobs that display on this list are labeled accordingly, with the number of sliced jobs that have run:</p>
<img alt="_images/sliced-job-shown-jobs-list-view.png" src="sliced-job-shown-jobs-list-view.png" />
</div>
<div class="section" id="scheduling">
<h2>15.5. Scheduling<a class="headerlink" href="job_templates.html#scheduling" title="Permalink to this headline">¶</a></h2>
<p id="index-1">Access the schedules for a particular job template from the <strong>Schedules</strong> tab. Otherwise, you can launch the scheduled jobs list via the <img alt="schedule" src="schedule-button.png" /> button. Scheduling from the job template page opens the <strong>Schedules</strong> page.</p>
<p><img alt="Job Templates - schedule launch" src="job-templates-schedules.png" /></p>
<p>This page displays a list of the schedules that are currently available for the selected <strong>Job Template</strong>. The schedule list may be sorted and searched by any of the following:</p>
<ul class="simple">
<li><strong>Name</strong>: Clicking the schedule name opens the <strong>Edit Schedule</strong> dialog</li>
<li><strong>First Run</strong>: The first scheduled run of this task</li>
<li><strong>Next Run</strong>: The next scheduled run of this task</li>
<li><strong>Final Run</strong>: If the task has an end date, this is the last run of the task</li>
</ul>
<p>Buttons located in the upper right corner of the <strong>Schedules</strong> screen provide the following actions:</p>
<ul class="simple">
<li>View Activity Stream</li>
<li>Add a new schedule</li>
</ul>
<div class="section" id="schedule-a-job-template">
<h3>15.5.1. Schedule a Job Template<a class="headerlink" href="job_templates.html#schedule-a-job-template" title="Permalink to this headline">¶</a></h3>
<p id="index-2">To create a new schedule:</p>
<ol class="arabic simple">
<li>From the Schedules screen, click the <img alt="add" src="add-button.png" /> button.</li>
<li>Enter the appropriate details into the following fields:</li>
</ol>
<ul class="simple">
<li><strong>Name</strong></li>
<li><strong>Start Date</strong></li>
<li><strong>Start Time</strong></li>
<li><strong>Local Time Zone</strong>: the entered Start Time should be in this timezone</li>
<li><strong>Repeat Frequency</strong>: the appropriate options display as the update frequency is modified</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Jobs are scheduled in UTC. Repeating jobs that runs at a specific time of day may move relative to a local timezone when Daylight Saving Time shifts occur.</p>
</div>
<p>The Schedule Description below displays the specifics of the schedule and a list of the scheduled occurrences in the selected Local Time Zone.</p>
<p><img alt="Job Template - schedule add" src="job-templates-schedules-new-add.png" /></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If <strong>Prompt on Launch</strong> was selected for the <strong>Credentials</strong> field, and you create or edit scheduling information for your job template, a <strong>Prompt</strong> button displays at the bottom of the Schedules form. You will not be able to remove the default machine credential in the Prompt dialog without replacing it with another machine credential before you can save it. Below is an example of such a message:</p>
<blockquote class="last">
<div><img alt="_images/prompt-default-creds-missing-schedule.png" src="prompt-default-creds-missing-schedule.png" />
</div></blockquote>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To able to set <code class="docutils literal"><span class="pre">extra_vars</span></code> on schedules, you must select <strong>Prompt on Launch</strong> for <strong>EXTRA VARIABLES</strong> on the job template, or a enable a survey on the job template, then those answered survey questions become <code class="docutils literal"><span class="pre">extra_vars</span></code>.</p>
</div>
<ol class="arabic simple" start="3">
<li>When satisfied with the schedule specifics, click <strong>Save</strong>.</li>
</ol>
<p>Once the schedule is saved, the list of schedules display for the associated job template.</p>
<p>Use the <strong>ON/OFF</strong> toggle button to quickly activate or deactivate this schedule.</p>
<p>Other actions for schedules are available under the Actions column:</p>
<ul class="simple">
<li>Edit Schedule</li>
<li>Delete schedule</li>
</ul>
</div>
</div>
<div class="section" id="surveys">
<span id="ug-surveys"></span><h2>15.6. Surveys<a class="headerlink" href="job_templates.html#surveys" title="Permalink to this headline">¶</a></h2>
<p id="index-3">Job types of Run or Check will provide a way to set up surveys in the Job Template creation or editing screens. Surveys set extra variables for the playbook similar to &#8216;Prompt for Extra Variables&#8217; does, but in a user-friendly question and answer way. Surveys also allow for validation of user input. Click the <img alt="survey" src="add-survey-button.png" /> button to create a survey.</p>
<p>Use cases for surveys are numerous. An example might be if operations wanted to give developers a &#8220;push to stage&#8221; button they could run without advanced Ansible knowledge. When launched, this task could prompt for answers to questions such as, &#8220;What tag should we release?&#8221;</p>
<p>Many types of questions can be asked, including multiple-choice questions.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Surveys are only available to those with Enterprise-level licenses.</p>
</div>
<div class="section" id="create-a-survey">
<span id="ug-surveys-create"></span><h3>15.6.1. Create a Survey<a class="headerlink" href="job_templates.html#create-a-survey" title="Permalink to this headline">¶</a></h3>
<p id="index-4">To create a survey:</p>
<ol class="arabic simple">
<li>Click on the <img alt="survey" src="add-survey-button.png" /> button to bring up the <strong>Add Survey</strong> window.</li>
</ol>
<div class="figure">
<img alt="Job template - create survey" src="job-template-create-survey.png" />
</div>
<p>Use the <strong>ON/OFF</strong> toggle button at the top of the screen to quickly activate or deactivate this survey prompt.</p>
<ol class="arabic simple" start="2">
<li>A survey can consist of any number of questions. For each question, enter the following information:</li>
</ol>
<ul class="simple">
<li><strong>Name</strong>: The question to ask the user</li>
<li><strong>Description</strong>: (optional) A description of what&#8217;s being asked of the user.</li>
<li><strong>Answer Variable Name</strong>: The Ansible variable name to store the user&#8217;s response in. This is the variable to be used by the playbook. Variable names cannot contain spaces.</li>
<li><strong>Answer Type</strong>: Choose from the following question types.<ul>
<li><em>Text</em>: A single line of text. You can set the minimum and maximum length (in characters) for this answer.</li>
<li><em>Textarea</em>: A multi-line text field. You can set the minimum and maximum length (in characters) for this answer.</li>
<li><em>Password</em>: Responses are treated as sensitive information, much like an actual password is treated. You can set the minimum and maximum length (in characters) for this answer.</li>
<li><em>Multiple Choice (single select)</em>: A list of options, of which only one can be selected at a time. Enter the options, one per line, in the <strong>Multiple Choice Options</strong> box.</li>
<li><em>Multiple Choice (multiple select)</em>: A list of options, any number
of which can be selected at a time. Enter the options, one per
line, in the <strong>Multiple Choice Options</strong> box.</li>
<li><em>Integer</em>: An integer number. You can set the minimum and maximum length (in characters) for this answer.</li>
<li><em>Float</em>: A decimal number. You can set the minimum and maximum length (in characters) for this answer.</li>
</ul>
</li>
<li><strong>Default Answer</strong>: The default answer to the question. This value is pre-filled in the interface and is used if the answer is not provided by the user.</li>
<li><strong>Required</strong>: Whether or not an answer to this question is required from the user.</li>
</ul>
<ol class="arabic simple" start="3">
<li>Once you have entered the question information, click the <img alt="add" src="add-button.png" /> button to add the question.</li>
</ol>
<p>A stylized version of the survey is presented in the Preview pane. For any question, you can click on the <strong>Edit</strong> button to edit the question, the <strong>Delete</strong> button to delete the question, and click and drag on the grid icon to rearrange the order of the questions.</p>
<ol class="arabic simple" start="4">
<li>Return to the left pane to add additional questions.</li>
<li>When done, click <strong>Save</strong> to save the survey.</li>
</ol>
<p><img alt="job-template-completed-survey" src="job-template-completed-survey.png" /></p>
</div>
<div class="section" id="optional-survey-questions">
<h3>15.6.2. Optional Survey Questions<a class="headerlink" href="job_templates.html#optional-survey-questions" title="Permalink to this headline">¶</a></h3>
<p id="index-5">The <strong>Required</strong> setting on a survey question determines whether the answer is optional or not for the user interacting with it.</p>
<p>Behind the scenes, optional survey variables can be passed to the playbook in <code class="docutils literal"><span class="pre">extra_vars</span></code>, even when they aren&#8217;t filled in.</p>
<ul class="simple">
<li>If a non-text variable (input type) is marked as optional, and is not filled in, no survey <code class="docutils literal"><span class="pre">extra_var</span></code> is passed to the playbook.</li>
<li>If a text input or text area input is marked as optional, is not filled in, and has a minimum <code class="docutils literal"><span class="pre">length</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, no survey <code class="docutils literal"><span class="pre">extra_var</span></code> is passed to the playbook.</li>
<li>If a text input or text area input is marked as optional, is not filled in, and has a minimum <code class="docutils literal"><span class="pre">length</span> <span class="pre">===</span> <span class="pre">0</span></code>, that survey <code class="docutils literal"><span class="pre">extra_var</span></code> is passed to the playbook, with the value set to an empty string ( &#8220;&#8221; ).</li>
</ul>
</div>
</div>
<div class="section" id="launch-a-job-template">
<h2>15.7. Launch a Job Template<a class="headerlink" href="job_templates.html#launch-a-job-template" title="Permalink to this headline">¶</a></h2>
<p id="index-6">A major benefit of Ansible Tower is the push-button deployment of Ansible playbooks. You can easily configure a template within Tower to store all parameters you would normally pass to the ansible-playbook on the command line&#8211;not just the playbooks, but the inventory, credentials, extra variables, and all options and settings you can specify on the command line.</p>
<p>Easier deployments drive consistency, by running your playbooks the same way each time, and allow you to delegate responsibilities&#8211;even users who aren’t Ansible experts can run Tower playbooks written by others.</p>
<p>To launch a job template:</p>
<ol class="arabic simple">
<li>Access the job template from the <strong>Templates</strong> navigational link or while in the Job Template Details view, scroll to the bottom to access it from a list of templates.</li>
</ol>
<p><img alt="Job Templates" src="job-templates-list.png" /></p>
<ol class="arabic simple" start="2">
<li>Click the <img alt="launch" src="launch-button.png" /> button.</li>
</ol>
<p>A job may require additional information to run. The following data may be requested at launch:</p>
<ul class="simple">
<li>Credentials that were setup</li>
<li>Passwords or passphrases that have been set to <strong>Ask</strong></li>
<li>A survey, if one has been configured for the job templates</li>
<li>Extra variables, if requested by the job template</li>
</ul>
<p>Below is an example job launch that prompts for Job Tags, and runs the example survey created in <a class="reference internal" href="job_templates.html#ug-surveys"><span class="std std-ref">Surveys</span></a>.</p>
<p><img alt="job-launch-with-prompt-job-tags" src="job-launch-with-prompt-at-launch-jobtags.png" /></p>
<p><img alt="job-launch-with-prompt-survey" src="job-launch-with-prompt-at-launch-survey.png" /></p>
<p>Along with any extra variables set in the job template and survey, Tower automatically adds the following variables to the job environment:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tower_job_id</span></code>: The Job ID for this job run</li>
<li><code class="docutils literal"><span class="pre">tower_job_launch_type</span></code>: The description to indicate how the job was started:<ul>
<li><strong>manual</strong>: Job was started manually by a user.</li>
<li><strong>relaunch</strong>: Job was started via relaunch.</li>
<li><strong>callback</strong>: Job was started via host callback.</li>
<li><strong>scheduled</strong>: Job was started from a schedule.</li>
<li><strong>dependency</strong>: Job was started as a dependency of another job.</li>
<li><strong>workflow</strong>: Job was started from a workflow job.</li>
<li><strong>sync</strong>: Job was started from a project sync.</li>
<li><strong>scm</strong>: Job was created as an Inventory SCM sync.</li>
<li><code class="docutils literal"><span class="pre">tower_job_template_id</span></code>: The Job Template ID that this job run uses</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">tower_job_template_name</span></code>: The Job Template name that this job uses</li>
<li><code class="docutils literal"><span class="pre">tower_user_id</span></code>: The user ID of the Tower user that started this job. This is not available for callback or scheduled jobs.</li>
<li><code class="docutils literal"><span class="pre">tower_user_name</span></code>: The user name of the Tower user that started this job. This is not available for callback or scheduled jobs.</li>
<li><code class="docutils literal"><span class="pre">tower_schedule_id</span></code>: If applicable, the ID of the schedule that launched this job</li>
<li><code class="docutils literal"><span class="pre">tower_schedule_name</span></code>: If applicable, the name of the schedule that launched this job</li>
<li><code class="docutils literal"><span class="pre">tower_workflow_job_id</span></code>: If applicable, the ID of the workflow job that launched this job</li>
<li><code class="docutils literal"><span class="pre">tower_workflow_job_name</span></code>: If applicable, the name of the workflow job that launched this job. Note this is also the same as the workflow job template.</li>
</ul>
<p>All variables are also given an &#8220;awx&#8221; prefix, for example, <code class="docutils literal"><span class="pre">awx_job_id</span></code>.</p>
<p>Upon launch, Tower automatically redirects the web browser to the Job Status page for this job under the <strong>Jobs</strong> tab.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Starting with Ansible Tower 3.3, you can re-launch the most recent job from the list view to re-run on all hosts or just failed hosts in the specified inventory. Refer to <a class="reference internal" href="jobs.html#ug-jobs"><span class="std std-ref">Jobs</span></a> in the <em>Ansible Tower User Guide</em> for more detail.</p>
</div>
<p>When slice jobs are running, job lists display the workflow and job slices, as well as a link to view their details individually.</p>
<img alt="_images/sliced-job-shown-jobs-list-view.png" src="sliced-job-shown-jobs-list-view.png" />
</div>
<div class="section" id="copy-a-job-template">
<h2>15.8. Copy a Job Template<a class="headerlink" href="job_templates.html#copy-a-job-template" title="Permalink to this headline">¶</a></h2>
<p>Ansible Tower 3.0 introduced the ability to copy a Job Template. If you choose to copy Job Template, it <strong>does not</strong> copy any associated schedule, notifications, or permissions. Schedules and notifications must be recreated by the user or admin creating the copy of the Job Template. The user copying the Job Template will be granted the admin permission, but no permissions are assigned (copied) to the Job Template.</p>
<ol class="arabic simple">
<li>Access the job template that you want to copy from the <strong>Templates</strong> navigational link or while in the Job Template Details view, scroll to the bottom to access it from a list of templates.</li>
</ol>
<p><img alt="Job Templates" src="job-templates-list.png" /></p>
<ol class="arabic simple" start="2">
<li>Click the <img alt="copy" src="copy-button.png" /> button.</li>
</ol>
<p>A new template opens with the name of the template from which you copied and a timestamp.</p>
<ol class="arabic simple" start="3">
<li>Replace the contents of the <strong>Name</strong> field with a new name, and provide or modify the entries in the other fields to complete this page.</li>
<li>Click <strong>Save</strong> when done.</li>
</ol>
</div>
<div class="section" id="scan-job-templates">
<span id="ug-jobtemplates-scanjobs"></span><h2>15.9. Scan Job Templates<a class="headerlink" href="job_templates.html#scan-job-templates" title="Permalink to this headline">¶</a></h2>
<p id="index-7">Scan jobs are no longer supported starting with Ansible Tower 3.2. This system tracking feature was used as a way to capture and store facts as historical data. Facts are now stored in Tower via fact caching. For more information, see <a class="reference internal" href="job_templates.html#ug-fact-caching"><span class="std std-ref">Fact Caching</span></a>.</p>
<p>If you have Job Template Scan Jobs in your system prior to Ansible Tower 3.2, they have been converted to type run (like normal job templates) and retained their associated resources (i.e. inventory, credential). Job Template Scan Jobs that do not have a related project are assigned a special playbook by default, or you can specify a project with your own scan playbook. A project was created for each organization that points to  <a class="reference external" href="https://github.com/ansible/tower-fact-modules">https://github.com/ansible/tower-fact-modules</a> and the Job Template was set to the playbook, <a class="reference external" href="https://github.com/ansible/tower-fact-modules/blob/master/scan_facts.yml">https://github.com/ansible/tower-fact-modules/blob/master/scan_facts.yml</a>.</p>
<div class="section" id="fact-scan-playbooks">
<h3>15.9.1. Fact Scan Playbooks<a class="headerlink" href="job_templates.html#fact-scan-playbooks" title="Permalink to this headline">¶</a></h3>
<p id="index-8">The scan job playbook, <code class="docutils literal"><span class="pre">scan_facts.yml</span></code>, contains invocations of three <code class="docutils literal"><span class="pre">fact</span> <span class="pre">scan</span> <span class="pre">modules</span></code> - packages, services, and files, along with Ansible&#8217;s standard fact gathering. The <code class="docutils literal"><span class="pre">scan_facts.yml</span></code> playbook file looks like the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">hosts</span><span class="p">:</span> <span class="nb">all</span>
  <span class="nb">vars</span><span class="p">:</span>
    <span class="n">scan_use_checksum</span><span class="p">:</span> <span class="n">false</span>
    <span class="n">scan_use_recursive</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">tasks</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">scan_packages</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">scan_services</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">scan_files</span><span class="p">:</span>
        <span class="n">paths</span><span class="p">:</span> <span class="s1">&#39;{{ scan_file_paths }}&#39;</span>
        <span class="n">get_checksum</span><span class="p">:</span> <span class="s1">&#39;{{ scan_use_checksum }}&#39;</span>
        <span class="n">recursive</span><span class="p">:</span> <span class="s1">&#39;{{ scan_use_recursive }}&#39;</span>
      <span class="n">when</span><span class="p">:</span> <span class="n">scan_file_paths</span> <span class="ow">is</span> <span class="n">defined</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">scan_files</span></code> fact module is the only module that accepts parameters, passed via <code class="docutils literal"><span class="pre">extra_vars</span></code> on the scan job template.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">scan_file_paths</span><span class="p">:</span> <span class="s1">&#39;/tmp/&#39;</span>
<span class="n">scan_use_checksum</span><span class="p">:</span> <span class="n">true</span>
<span class="n">scan_use_recursive</span><span class="p">:</span> <span class="n">true</span>
</pre></div>
</div>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">scan_file_paths</span></code> parameter may have multiple settings (such as <code class="docutils literal"><span class="pre">/tmp/</span></code> or <code class="docutils literal"><span class="pre">/var/log</span></code>).</li>
<li>The <code class="docutils literal"><span class="pre">scan_use_checksum</span></code> and <code class="docutils literal"><span class="pre">scan_use_recursive</span></code> parameters may also be set to false or omitted. An omission is the same as a false setting.</li>
</ul>
<p>Scan job templates should enable <code class="docutils literal"><span class="pre">become</span></code> and use credentials for which <code class="docutils literal"><span class="pre">become</span></code> is a possibility. You can enable become by checking the <strong>Enable Privilege Escalation</strong> from the Options menu:</p>
<img alt="_images/job-templates-create-new-job-template-become.png" src="job-templates-create-new-job-template-become.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you maintained scan job templates in Ansible Tower 3.1.x and then upgrade to Ansible Tower 3.2, a new &#8220;Tower Fact Scan - Default&#8221; project is automatically created for you. This project contains the old scan playbook previously used in earlier versions of Ansible Tower.</p>
</div>
</div>
<div class="section" id="supported-oses-for-scan-facts-yml">
<h3>15.9.2. Supported OSes for <code class="docutils literal"><span class="pre">scan_facts.yml</span></code><a class="headerlink" href="job_templates.html#supported-oses-for-scan-facts-yml" title="Permalink to this headline">¶</a></h3>
<p>If you use the <code class="docutils literal"><span class="pre">scan_facts.yml</span></code> playbook with use fact cache, ensure that your OS is supported:</p>
<ul class="simple">
<li>Red Hat Enterprise Linux 5, 6, &amp; 7</li>
<li>CentOS 5, 6, &amp; 7</li>
<li>Ubuntu 12.04, 14.04, 16.04</li>
<li>OEL 6 &amp; 7</li>
<li>SLES 11 &amp; 12</li>
<li>Debian 6, 7, 8</li>
<li>Fedora 22, 23, 24</li>
<li>Amazon Linux 2016.03</li>
<li>Windows Server 2008 and later</li>
</ul>
<p>Note that some of these operating systems may require initial configuration in order to be able to run python and/or have access to the python packages (such as <code class="docutils literal"><span class="pre">python-apt</span></code>) that the scan modules depend on.</p>
</div>
<div class="section" id="pre-scan-setup">
<h3>15.9.3. Pre-scan Setup<a class="headerlink" href="job_templates.html#pre-scan-setup" title="Permalink to this headline">¶</a></h3>
<p>The following are examples of playbooks that configure certain distributions so that scan jobs can be run against them.</p>
<p><strong>Bootstrap Ubuntu (16.04)</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---</span>

<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Get</span> <span class="n">Ubuntu</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="ow">and</span> <span class="n">on</span> <span class="n">ready</span>
 <span class="n">hosts</span><span class="p">:</span> <span class="nb">all</span>
 <span class="n">sudo</span><span class="p">:</span> <span class="n">yes</span>
 <span class="n">gather_facts</span><span class="p">:</span> <span class="n">no</span>

 <span class="n">tasks</span><span class="p">:</span>

 <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">simplejson</span>
   <span class="n">raw</span><span class="p">:</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">y</span> <span class="n">update</span>
   <span class="n">raw</span><span class="p">:</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">simplejson</span>
   <span class="n">raw</span><span class="p">:</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">apt</span>
</pre></div>
</div>
<p><strong>Bootstrap Fedora (23, 24)</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---</span>

<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Get</span> <span class="n">Fedora</span> <span class="n">ready</span>
 <span class="n">hosts</span><span class="p">:</span> <span class="nb">all</span>
 <span class="n">sudo</span><span class="p">:</span> <span class="n">yes</span>
 <span class="n">gather_facts</span><span class="p">:</span> <span class="n">no</span>

 <span class="n">tasks</span><span class="p">:</span>

 <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">simplejson</span>
   <span class="n">raw</span><span class="p">:</span> <span class="n">sudo</span> <span class="n">dnf</span> <span class="o">-</span><span class="n">y</span> <span class="n">update</span>
   <span class="n">raw</span><span class="p">:</span> <span class="n">sudo</span> <span class="n">dnf</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">simplejson</span>
   <span class="n">raw</span><span class="p">:</span> <span class="n">sudo</span> <span class="n">dnf</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">rpm</span><span class="o">-</span><span class="n">python</span>
</pre></div>
</div>
<p>CentOS 5 or Red Hat Enterprise Linux 5 may also need the <code class="docutils literal"><span class="pre">simplejson</span></code> package installed.</p>
</div>
<div class="section" id="custom-fact-scans">
<h3>15.9.4. Custom Fact Scans<a class="headerlink" href="job_templates.html#custom-fact-scans" title="Permalink to this headline">¶</a></h3>
<p id="index-9">A playbook for a custom fact scan is similar to the example of the Fact Scan Playbook above. As an example, a playbook that only uses a custom <code class="docutils literal"><span class="pre">scan_foo</span></code> Ansible fact module would look like this:</p>
<p><em>scan_custom.yml</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">hosts</span><span class="p">:</span> <span class="nb">all</span>
  <span class="n">gather_facts</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">tasks</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">scan_foo</span><span class="p">:</span>
</pre></div>
</div>
<p><em>scan_foo.py</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span>
        <span class="n">argument_spec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">())</span>

    <span class="n">foo</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ansible_facts</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="n">foo</span><span class="p">))</span>
    <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span><span class="o">**</span><span class="n">results</span><span class="p">)</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>To use a custom fact module, ensure that it lives in the <code class="docutils literal"><span class="pre">/library/</span></code> subdirectory of the Ansible project used in the scan job template. This fact scan module is very simple, returning a hard-coded set of facts:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span>
   <span class="p">{</span>
     <span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span>
   <span class="p">},</span>
   <span class="p">{</span>
     <span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span>
   <span class="p">}</span>
 <span class="p">]</span>
</pre></div>
</div>
<p>Refer to the <a class="reference external" href="http://docs.ansible.com/ansible/latest/dev_guide/developing_modules_general.html#module-provided-facts">Module Provided &#8216;Facts&#8217;</a> section of the Ansible documentation for more information.</p>
<blockquote>
<div></div></blockquote>
</div>
</div>
<div class="section" id="fact-caching">
<span id="ug-fact-caching"></span><h2>15.10. Fact Caching<a class="headerlink" href="job_templates.html#fact-caching" title="Permalink to this headline">¶</a></h2>
<p id="index-10">Tower can store and retrieve facts on a per-host basis through an Ansible Fact Cache plugin. This behavior is configurable on a per-job template basis. Fact caching is turned off by default but can be enabled to serve fact requests for all hosts in an inventory related to the job running. This allows you to use job templates with <code class="docutils literal"><span class="pre">--limit</span></code> while still having access to the entire inventory of host facts. A global timeout setting that the plugin enforces per-host, can be specified (in seconds) through the Configure Tower interface under the Jobs tab:</p>
<img alt="_images/configure-tower-jobs-fact-cache-timeout.png" src="configure-tower-jobs-fact-cache-timeout.png" />
<p>Upon launching a job that uses fact cache (<code class="docutils literal"><span class="pre">use_fact_cache=True</span></code>), Tower will inject into memcached, all <code class="docutils literal"><span class="pre">ansible_facts</span></code> associated with each host in the inventory associated with the job. A list of all hosts in the inventory is also injected into memcached with the <code class="docutils literal"><span class="pre">inventory_id</span></code> key and host name values. The Ansible Fact Cache plugin that ships with Ansible Tower will only be enabled on jobs with fact cache enabled (<code class="docutils literal"><span class="pre">use_fact_cache=True</span></code>). The fact cache plugin running in Ansible will connect to the same memcached instance.</p>
<p>When a job finishes running that has fact cache enabled (<code class="docutils literal"><span class="pre">use_fact_cache=True</span></code>), Tower will go through memcached and retrieve all records for the hosts in the inventory. Any records with update times newer than the currently stored facts per-host will be saved to the database.</p>
<p>Tower will always inject the host <code class="docutils literal"><span class="pre">ansible_facts</span></code> into memcached. The cached values may or may not be displayed, based on the per-host newly-stored facts and the timeout value specified for the global fact cache setting.</p>
<p>New and changed facts will be logged via Tower&#8217;s logging facility. Specifically, to the <code class="docutils literal"><span class="pre">system_tracking</span></code> namespace or logger. The logging payload will include the fields:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">host_name</span></code></li>
<li><code class="docutils literal"><span class="pre">inventory_id</span></code></li>
<li><code class="docutils literal"><span class="pre">ansible_facts</span></code></li>
</ul>
</div></blockquote>
<p>where <code class="docutils literal"><span class="pre">ansible_facts</span></code> is a dictionary of all Ansible facts for <code class="docutils literal"><span class="pre">host_name</span></code> in Tower inventory, <code class="docutils literal"><span class="pre">inventory_id</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If a hostname includes a forward slash (<code class="docutils literal"><span class="pre">/</span></code>), fact cache will not work for that host. If you have an inventory with 100 hosts and one host has a <code class="docutils literal"><span class="pre">/</span></code> in the name, 99 of those hosts will still collect facts.</p>
</div>
<div class="section" id="benefits-of-fact-caching">
<h3>15.10.1. Benefits of Fact Caching<a class="headerlink" href="job_templates.html#benefits-of-fact-caching" title="Permalink to this headline">¶</a></h3>
<p>Fact caching saves a significant amount of time over running fact gathering. If you have a playbook in a job that runs against a thousand hosts and forks, you could easily spend 10 minutes gathering facts across all of those hosts. But if you run a job on a regular basis, the first run of it caches these facts and the next run will just pull them from the database. This cuts the runtime of jobs against large inventories, including Smart Inventories, by an enormous magnitude.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not modify the <code class="docutils literal"><span class="pre">tower.cfg</span></code> file to apply fact caching. Custom fact caching could conflict with Tower&#8217;s fact caching feature. It is recommended to use the fact caching module that comes with Ansible Tower. Fact caching is not supported for isolated nodes.</p>
</div>
<p>You can choose to use cached facts in your job by enabling it in the <strong>Options</strong> field of the Job Templates window.</p>
<img alt="_images/job-templates-options-use-factcache.png" src="job-templates-options-use-factcache.png" />
<p>To clear facts, you need to run the Ansible <code class="docutils literal"><span class="pre">clear_facts</span></code> <a class="reference external" href="http://docs.ansible.com/ansible/latest/modules/meta_module.html#examples">meta task</a>. Below is an example playbook that uses the Ansible <code class="docutils literal"><span class="pre">clear_facts</span></code> meta task.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">hosts</span><span class="p">:</span> <span class="nb">all</span>
  <span class="n">gather_facts</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">tasks</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Clear</span> <span class="n">gathered</span> <span class="n">facts</span> <span class="kn">from</span> <span class="nn">all</span> <span class="n">currently</span> <span class="n">targeted</span> <span class="n">hosts</span>
      <span class="n">meta</span><span class="p">:</span> <span class="n">clear_facts</span>
</pre></div>
</div>
<p>The API endpoint for fact caching can be found at: <code class="docutils literal"><span class="pre">http://&lt;Tower</span> <span class="pre">server</span> <span class="pre">name&gt;/api/v2/hosts/x/ansible_facts</span></code>.</p>
</div>
</div>
<div class="section" id="utilizing-cloud-credentials">
<span id="ug-cloudcredentials"></span><h2>15.11. Utilizing Cloud Credentials<a class="headerlink" href="job_templates.html#utilizing-cloud-credentials" title="Permalink to this headline">¶</a></h2>
<p id="index-11">Cloud Credentials can be used when syncing a respective cloud inventory. Cloud Credentials may also be associated with a Job Template and included in the runtime environment for use by a playbook. Cloud Credentials were introduced in Ansible Tower version 2.4.0 and these are currently supported:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="job_templates.html#openstack" id="id1">OpenStack</a></li>
<li><a class="reference internal" href="job_templates.html#amazon-web-services" id="id2">Amazon Web Services</a></li>
<li><a class="reference internal" href="job_templates.html#rackspace" id="id3">Rackspace</a></li>
<li><a class="reference internal" href="job_templates.html#google" id="id4">Google</a></li>
<li><a class="reference internal" href="job_templates.html#azure" id="id5">Azure</a></li>
<li><a class="reference internal" href="job_templates.html#vmware" id="id6">VMware</a></li>
</ul>
</div>
<div class="section" id="openstack">
<h3><a class="toc-backref" href="job_templates.html#id1">15.11.1. OpenStack</a><a class="headerlink" href="job_templates.html#openstack" title="Permalink to this headline">¶</a></h3>
<p id="index-12">The sample playbook below invokes the <code class="docutils literal"><span class="pre">nova_compute</span></code> Ansible OpenStack cloud module and requires credentials to do anything meaningful, and specifically requires the following information: <code class="docutils literal"><span class="pre">auth_url</span></code>, <code class="docutils literal"><span class="pre">username</span></code>, <code class="docutils literal"><span class="pre">password</span></code>, and <code class="docutils literal"><span class="pre">project_name</span></code>. These fields are made available to the playbook via the environmental variable <code class="docutils literal"><span class="pre">OS_CLIENT_CONFIG_FILE</span></code>, which points to a YAML file written by Tower based on the contents of the cloud credential. This sample playbook loads the YAML file into the Ansible variable space.</p>
<p><code class="docutils literal"><span class="pre">OS_CLIENT_CONFIG_FILE</span></code> example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">clouds</span><span class="p">:</span>
  <span class="n">devstack</span><span class="p">:</span>
    <span class="n">auth</span><span class="p">:</span>
      <span class="n">auth_url</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">devstack</span><span class="o">.</span><span class="n">yoursite</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">5000</span><span class="o">/</span><span class="n">v2</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span>
      <span class="n">username</span><span class="p">:</span> <span class="n">admin</span>
      <span class="n">password</span><span class="p">:</span> <span class="n">your_password_here</span>
      <span class="n">project_name</span><span class="p">:</span> <span class="n">demo</span>
</pre></div>
</div>
<p>Playbook example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">hosts</span><span class="p">:</span> <span class="nb">all</span>
  <span class="n">gather_facts</span><span class="p">:</span> <span class="n">false</span>
  <span class="nb">vars</span><span class="p">:</span>
    <span class="n">config_file</span><span class="p">:</span> <span class="s2">&quot;{{ lookup(&#39;env&#39;, &#39;OS_CLIENT_CONFIG_FILE&#39;) }}&quot;</span>
    <span class="n">nova_tenant_name</span><span class="p">:</span> <span class="n">demo</span>
    <span class="n">nova_image_name</span><span class="p">:</span> <span class="s2">&quot;cirros-0.3.2-x86_64-uec&quot;</span>
    <span class="n">nova_instance_name</span><span class="p">:</span> <span class="n">autobot</span>
    <span class="n">nova_instance_state</span><span class="p">:</span> <span class="s1">&#39;present&#39;</span>
    <span class="n">nova_flavor_name</span><span class="p">:</span> <span class="n">m1</span><span class="o">.</span><span class="n">nano</span>

    <span class="n">nova_group</span><span class="p">:</span>
      <span class="n">group_name</span><span class="p">:</span> <span class="n">antarctica</span>
      <span class="n">instance_name</span><span class="p">:</span> <span class="n">deceptacon</span>
      <span class="n">instance_count</span><span class="p">:</span> <span class="mi">3</span>
  <span class="n">tasks</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">debug</span><span class="p">:</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;{{ config_file }}&quot;</span>
    <span class="o">-</span> <span class="n">stat</span><span class="p">:</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;{{ config_file }}&quot;</span>
      <span class="n">register</span><span class="p">:</span> <span class="n">st</span>
    <span class="o">-</span> <span class="n">include_vars</span><span class="p">:</span> <span class="s2">&quot;{{ config_file }}&quot;</span>
      <span class="n">when</span><span class="p">:</span> <span class="n">st</span><span class="o">.</span><span class="n">stat</span><span class="o">.</span><span class="n">exists</span> <span class="ow">and</span> <span class="n">st</span><span class="o">.</span><span class="n">stat</span><span class="o">.</span><span class="n">isreg</span>

    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Print out clouds variable&quot;</span>
      <span class="n">debug</span><span class="p">:</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;{{ clouds|default(&#39;No clouds found&#39;) }}&quot;</span>

    <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Setting nova instance state to: {{ nova_instance_state }}&quot;</span>
      <span class="n">local_action</span><span class="p">:</span>
        <span class="n">module</span><span class="p">:</span> <span class="n">nova_compute</span>
        <span class="n">login_username</span><span class="p">:</span> <span class="s2">&quot;{{ clouds.devstack.auth.username }}&quot;</span>
        <span class="n">login_password</span><span class="p">:</span> <span class="s2">&quot;{{ clouds.devstack.auth.password }}&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="amazon-web-services">
<h3><a class="toc-backref" href="job_templates.html#id2">15.11.2. Amazon Web Services</a><a class="headerlink" href="job_templates.html#amazon-web-services" title="Permalink to this headline">¶</a></h3>
<p id="index-13">Amazon Web Services cloud credentials are exposed as the following environment variables during playbook execution (in the job template, choose the cloud credential needed for your setup):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">AWS_ACCESS_KEY_ID</span></code></li>
<li><code class="docutils literal"><span class="pre">AWS_SECRET_ACCESS_KEY</span></code></li>
</ul>
<p>All of the AWS modules will implicitly use these credentials when run via Tower without having to set the <code class="docutils literal"><span class="pre">aws_access_key_id</span></code> or <code class="docutils literal"><span class="pre">aws_secret_access_key</span></code> module options.</p>
</div>
<div class="section" id="rackspace">
<h3><a class="toc-backref" href="job_templates.html#id3">15.11.3. Rackspace</a><a class="headerlink" href="job_templates.html#rackspace" title="Permalink to this headline">¶</a></h3>
<p id="index-14">Rackspace cloud credentials are exposed as the following environment variables during playbook execution (in the job template, choose the cloud credential needed for your setup):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">RAX_USERNAME</span></code></li>
<li><code class="docutils literal"><span class="pre">RAX_API_KEY</span></code></li>
</ul>
<p>All of the Rackspace modules will implicitly use these credentials when run via Tower without having to set the <code class="docutils literal"><span class="pre">username</span></code> or <code class="docutils literal"><span class="pre">api_key</span></code> module options.</p>
</div>
<div class="section" id="google">
<h3><a class="toc-backref" href="job_templates.html#id4">15.11.4. Google</a><a class="headerlink" href="job_templates.html#google" title="Permalink to this headline">¶</a></h3>
<p id="index-15">Google cloud credentials are exposed as the following environment variables during playbook execution (in the job template, choose the cloud credential needed for your setup):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">GCE_EMAIL</span></code></li>
<li><code class="docutils literal"><span class="pre">GCE_PROJECT</span></code></li>
<li><code class="docutils literal"><span class="pre">GCE_CREDENTIALS_FILE_PATH</span></code></li>
</ul>
<p>All of the Google modules will implicitly use these credentials when run via Tower without having to set the <code class="docutils literal"><span class="pre">service_account_email</span></code>, <code class="docutils literal"><span class="pre">project_id</span></code>, or <code class="docutils literal"><span class="pre">pem_file</span></code> module options.</p>
</div>
<div class="section" id="azure">
<h3><a class="toc-backref" href="job_templates.html#id5">15.11.5. Azure</a><a class="headerlink" href="job_templates.html#azure" title="Permalink to this headline">¶</a></h3>
<p id="index-16">Azure cloud credentials are exposed as the following environment variables during playbook execution (in the job template, choose the cloud credential needed for your setup):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">AZURE_SUBSCRIPTION_ID</span></code></li>
<li><code class="docutils literal"><span class="pre">AZURE_CERT_PATH</span></code></li>
</ul>
<p>All of the Azure modules implicitly use these credentials when run via Tower without having to set the <code class="docutils literal"><span class="pre">subscription_id</span></code> or <code class="docutils literal"><span class="pre">management_cert_path</span></code> module options.</p>
</div>
<div class="section" id="vmware">
<h3><a class="toc-backref" href="job_templates.html#id6">15.11.6. VMware</a><a class="headerlink" href="job_templates.html#vmware" title="Permalink to this headline">¶</a></h3>
<p id="index-17">VMware cloud credentials are exposed as the following environment variables during playbook execution (in the job template, choose the cloud credential needed for your setup):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">VMWARE_USER</span></code></li>
<li><code class="docutils literal"><span class="pre">VMWARE_PASSWORD</span></code></li>
<li><code class="docutils literal"><span class="pre">VMWARE_HOST</span></code></li>
</ul>
<p>The sample playbook below demonstrates usage of these credentials:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">vsphere_guest</span><span class="p">:</span>
    <span class="n">vcenter_hostname</span><span class="p">:</span> <span class="s2">&quot;{{ lookup(&#39;env&#39;, &#39;VMWARE_HOST&#39;) }}&quot;</span>
    <span class="n">username</span><span class="p">:</span> <span class="s2">&quot;{{ lookup(&#39;env&#39;, &#39;VMWARE_USER&#39;) }}&quot;</span>
    <span class="n">password</span><span class="p">:</span> <span class="s2">&quot;{{ lookup(&#39;env&#39;, &#39;VMWARE_PASSWORD&#39;) }}&quot;</span>
    <span class="n">guest</span><span class="p">:</span> <span class="n">newvm001</span>
    <span class="n">from_template</span><span class="p">:</span> <span class="n">yes</span>
    <span class="n">template_src</span><span class="p">:</span> <span class="n">centosTemplate</span>
    <span class="n">cluster</span><span class="p">:</span> <span class="n">MainCluster</span>
    <span class="n">resource_pool</span><span class="p">:</span> <span class="s2">&quot;/Resources&quot;</span>
    <span class="n">vm_extra_config</span><span class="p">:</span>
      <span class="n">folder</span><span class="p">:</span> <span class="n">MyFolder</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="provisioning-callbacks">
<span id="ug-provisioning-callbacks"></span><h2>15.12. Provisioning Callbacks<a class="headerlink" href="job_templates.html#provisioning-callbacks" title="Permalink to this headline">¶</a></h2>
<p id="index-18">Provisioning callbacks are a feature of Tower that allow a host to initiate a playbook run against itself, rather than waiting for a user to launch a job to manage the host from the tower console. Please note that provisioning callbacks are <em>only</em> used to run playbooks on the calling host. Provisioning callbacks are meant for cloud bursting, ie: new instances with a need for client to server communication for configuration (such as transmitting an authorization key), not to run a job against another host. This provides for automatically configuring a system after it has been provisioned by another system (such as AWS auto-scaling, or a OS provisioning system like kickstart or preseed) or for launching a job programmatically without invoking the Tower API directly. The Job Template launched only runs against the host requesting the provisioning.</p>
<p>Frequently this would be accessed via a firstboot type script, or from cron.</p>
<p>To enable callbacks, check the <em>Allow Provisioning Callbacks</em> checkbox in the Job Template. This displays the <strong>Provisioning Callback URL</strong> for this job template.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you intend to use Tower&#8217;s provisioning callback feature with a dynamic inventory, Update on Launch should be set for the inventory group used in the Job Template.</p>
</div>
<img alt="_images/provisioning-callbacks-config.png" src="provisioning-callbacks-config.png" />
<p>Callbacks also require a Host Config Key, to ensure that foreign hosts with the URL cannot request configuration. Click the <img alt="create" src="create-button.png" /> button to create a unique host key for this callback, or enter your own key. The host key may be reused across multiple hosts to apply this job template against multiple hosts. Should you wish to control what hosts are able to request configuration, the key may be changed at any time.</p>
<p>To callback manually via REST, look at the callback URL in the UI, which is of the form:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">Tower</span> <span class="n">server</span> <span class="n">name</span><span class="o">&gt;/</span><span class="n">api</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">job_templates</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">callback</span><span class="o">/</span>
</pre></div>
</div>
<p>The &#8216;1&#8217; in this sample URL is the job template ID in Tower.</p>
<p>The request from the host must be a POST. Here is an example using curl (all on a single line):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><a href="https://docs.ansible.com/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9ceef3f3e8dcf0f3fffdf0f4f3efe8">[email&#160;protected]</a>:~$ curl -k -f -i -H &#39;Content-Type:application/json&#39; -XPOST -d &#39;{&quot;host_config_key&quot;: &quot;cfbaae23-81c0-47f8-9a40-44493b82f06a&quot;}&#39;
                  https://&lt;Tower server name&gt;/api/v2/job_templates/1/callback/
</pre></div>
</div>
<p>The requesting host must be defined in your inventory for the callback to succeed. If Tower fails to locate the host either by name or IP address in one of your defined inventories, the request is denied. When running a Job Template in this way, the host initiating the playbook run against itself must be in the inventory. If the host is missing from the inventory, the Job Template will fail with a &#8220;No Hosts Matched&#8221; type error message.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If your host is not in inventory and <code class="docutils literal"><span class="pre">Update</span> <span class="pre">on</span> <span class="pre">Launch</span></code> is set for the inventory group, Tower attempts to update cloud based inventory source before running the callback.</p>
</div>
<p>Successful requests result in an entry on the Jobs tab, where the results and history can be viewed.</p>
<p>While the callback can be accessed via REST, the suggested method of using the callback is to use one of the example scripts that ships with Tower - <code class="docutils literal"><span class="pre">/usr/share/awx/request_tower_configuration.sh</span></code> (Linux/UNIX) or <code class="docutils literal"><span class="pre">/usr/share/awx/request_tower_configuration.ps1</span></code> (Windows). Usage is described in the source code of the file by passing the <code class="docutils literal"><span class="pre">-h</span></code> flag, as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">request_tower_configuration</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">h</span>
<span class="n">Usage</span><span class="p">:</span> <span class="o">./</span><span class="n">request_tower_configuration</span><span class="o">.</span><span class="n">sh</span> <span class="o">&lt;</span><span class="n">options</span><span class="o">&gt;</span>

<span class="n">Request</span> <span class="n">server</span> <span class="n">configuration</span> <span class="kn">from</span> <span class="nn">Ansible</span> <span class="n">Tower</span><span class="o">.</span>

<span class="n">OPTIONS</span><span class="p">:</span>
   <span class="o">-</span><span class="n">h</span>      <span class="n">Show</span> <span class="n">this</span> <span class="n">message</span>
   <span class="o">-</span><span class="n">s</span>      <span class="n">Tower</span> <span class="n">server</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">tower</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">)</span> <span class="p">(</span><span class="n">required</span><span class="p">)</span>
   <span class="o">-</span><span class="n">k</span>      <span class="n">Allow</span> <span class="n">insecure</span> <span class="n">SSL</span> <span class="n">connections</span> <span class="ow">and</span> <span class="n">transfers</span>
   <span class="o">-</span><span class="n">c</span>      <span class="n">Host</span> <span class="n">config</span> <span class="n">key</span> <span class="p">(</span><span class="n">required</span><span class="p">)</span>
   <span class="o">-</span><span class="n">t</span>      <span class="n">Job</span> <span class="n">template</span> <span class="n">ID</span> <span class="p">(</span><span class="n">required</span><span class="p">)</span>
   <span class="o">-</span><span class="n">e</span>      <span class="n">Extra</span> <span class="n">variables</span>
   <span class="o">-</span><span class="n">s</span>      <span class="n">Number</span> <span class="n">of</span> <span class="n">seconds</span> <span class="n">between</span> <span class="n">retries</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
<p>This script is intelligent in that it knows how to retry commands and is therefore a more robust way to use callbacks than a simple curl request. As written, the script retries once per minute for up to ten minutes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please note that this is an example script. You should edit this script if you need more dynamic behavior when detecting failure scenarios, as any non-200 error code may not be a transient error requiring retry.</p>
</div>
<p>Most likely you will use callbacks with dynamic inventory in Tower, such as pulling cloud inventory from one of the supported cloud providers. In these cases, along with setting <em>Update On Launch</em>, be sure to configure an inventory cache timeout for the inventory source, to avoid hammering of your Cloud&#8217;s API endpoints. Since the <code class="docutils literal"><span class="pre">request_tower_configuration.sh</span></code> script polls once per minute for up to ten minutes, a suggested cache invalidation time for inventory (configured on the inventory source itself) would be one or two minutes.</p>
<p>While we recommend against running the <code class="docutils literal"><span class="pre">request_tower_configuration.sh</span></code> script from a cron job, a suggested cron interval would be perhaps every 30 minutes. Repeated configuration can be easily handled by scheduling in Tower, so the primary use of callbacks by most users is to enable a base image that is bootstrapped into the latest configuration upon coming online. To do so, running at first boot is a better practice. First boot scripts are just simple init scripts that typically self-delete, so you would set up an init script that called a copy of the <code class="docutils literal"><span class="pre">request_tower_configuration.sh</span></code> script and make that into an autoscaling image.</p>
<div class="section" id="passing-extra-variables-to-provisioning-callbacks">
<h3>15.12.1. Passing Extra Variables to Provisioning Callbacks<a class="headerlink" href="job_templates.html#passing-extra-variables-to-provisioning-callbacks" title="Permalink to this headline">¶</a></h3>
<p id="index-19">Just as you can pass <code class="docutils literal"><span class="pre">extra_vars</span></code> in a regular Job Template, you can also pass them to provisioning callbacks. To pass <code class="docutils literal"><span class="pre">extra_vars</span></code>, the data sent must be part of the body of the POST request as application/json (as the content type). Use the following JSON format as an example when adding your own <code class="docutils literal"><span class="pre">extra_vars</span></code> to be passed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s1">&#39;{&quot;extra_vars&quot;: {&quot;variable1&quot;:&quot;value1&quot;,&quot;variable2&quot;:&quot;value2&quot;,...}}&#39;</span>
</pre></div>
</div>
<p>(Added in Ansible Tower version 2.2.0.)</p>
<p>You can also pass extra variables to the Job Template call using <code class="docutils literal"><span class="pre">curl</span></code>, such as is shown in the following example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><a href="https://docs.ansible.com/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="71031e1e05311d1e12101d191e0205">[email&#160;protected]</a>:~$ curl -f -H &#39;Content-Type: application/json&#39; -XPOST \
                 -d &#39;{&quot;host_config_key&quot;: &quot;5a8ec154832b780b9bdef1061764ae5a&quot;, &quot;extra_vars&quot;: &quot;{\&quot;foo\&quot;: \&quot;bar\&quot;}&quot;}&#39; \
                 http://&lt;Tower server name&gt;/api/v2/job_templates/1/callback
</pre></div>
</div>
<p>For more information, refer to <a class="reference external" href="http://docs.ansible.com/ansible-tower/3.4.3/html/administration/tipsandtricks.html#launch-jobs-curl" title="(in Ansible Tower Administration Guide v3.4.3)"><span class="xref std std-ref">Launching Jobs with Curl</span></a>.</p>
</div>
<div class="section" id="provisioning-callback-through-tower-cli">
<h3>15.12.2. Provisioning Callback through tower-cli<a class="headerlink" href="job_templates.html#provisioning-callback-through-tower-cli" title="Permalink to this headline">¶</a></h3>
<p>As an alternative to running the <code class="docutils literal"><span class="pre">request_tower_configuration.sh</span></code> script or a custom script, you can use tower-cli to make a provisioning callback, as in the following example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tower</span><span class="o">-</span><span class="n">cli</span> <span class="n">job_template</span> <span class="n">callback</span> <span class="o">--</span><span class="n">host</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;5a8ec154832b780b9bdef1061764ae5a&quot;</span> <span class="o">--</span><span class="n">extra</span><span class="o">-</span><span class="nb">vars</span><span class="o">=</span><span class="s2">&quot;foo: bar&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="extra-variables">
<span id="ug-jobtemplates-extravars"></span><h2>15.13. Extra Variables<a class="headerlink" href="job_templates.html#extra-variables" title="Permalink to this headline">¶</a></h2>
<div class="admonition note" id="index-20">
<p class="first admonition-title">Note</p>
<p>Additional strict <code class="docutils literal"><span class="pre">extra_vars</span></code> validation was added in Ansible Tower 3.0.0. <code class="docutils literal"><span class="pre">extra_vars</span></code> passed to the job launch API are only honored if one of the following is true:</p>
<ul class="last simple">
<li>They correspond to variables in an enabled survey</li>
<li><code class="docutils literal"><span class="pre">ask_variables_on_launch</span></code> is set to True</li>
</ul>
</div>
<p>When you pass survey variables, they are passed as extra variables (<code class="docutils literal"><span class="pre">extra_vars</span></code>) within Tower. This can be tricky, as passing extra variables to a job template (as you would do with a survey) can override other variables being passed from the inventory and project.</p>
<p>For example, say that you have a defined variable for an inventory for <code class="docutils literal"><span class="pre">debug</span> <span class="pre">=</span> <span class="pre">true</span></code>. It is entirely possible that this variable, <code class="docutils literal"><span class="pre">debug</span> <span class="pre">=</span> <span class="pre">true</span></code>, can be overridden in a job template survey.</p>
<p>To ensure that the variables you need to pass are not overridden, ensure they are included by redefining them in the survey. Keep in mind that extra variables can be defined at the inventory, group, and host levels.</p>
<div class="admonition note" id="index-21">
<p class="first admonition-title">Note</p>
<p class="last">Beginning with Ansible Tower version 2.4, the behavior for Job Template extra variables and Survey variables has changed. Previously, variables set using a Survey overrode any extra variables specified in the Job Template. In 2.4 and later, the Job Template extra variables dictionary is merged with the Survey variables. This may result in a change of behavior upon upgrading to 2.4.</p>
</div>
<p>Here are some simplified examples of extra_vars in YAML and JSON formats:</p>
<p>The configuration in YAML format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">launch_to_orbit</span><span class="p">:</span> <span class="n">true</span>
<span class="n">satellites</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">sputnik</span>
  <span class="o">-</span> <span class="n">explorer</span>
  <span class="o">-</span> <span class="n">satcom</span>
</pre></div>
</div>
<p>The configuration in JSON format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;launch_to_orbit&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;satellites&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sputnik&quot;</span><span class="p">,</span> <span class="s2">&quot;explorer&quot;</span><span class="p">,</span> <span class="s2">&quot;satcom&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following table notes the behavior (hierarchy) of variable precedence in Ansible Tower as it compares to variable precedence in Ansible.</p>
<p><strong>Ansible Tower Variable Precedence Hierarchy (last listed wins)</strong></p>
<img alt="_images/Architecture-Tower_Variable_Precedence_Hierarchy.png" src="Architecture-Tower_Variable_Precedence_Hierarchy.png" />
<div class="section" id="relaunching-job-templates">
<h3>15.13.1. Relaunching Job Templates<a class="headerlink" href="job_templates.html#relaunching-job-templates" title="Permalink to this headline">¶</a></h3>
<p id="index-22">Another change for Ansible Tower version 2.4  introduced a <code class="docutils literal"><span class="pre">launch_type</span></code> setting for your jobs. Instead of manually relaunching a job, a relaunch is denoted by setting <code class="docutils literal"><span class="pre">launch_type</span></code> to <code class="docutils literal"><span class="pre">relaunch</span></code>. The relaunch behavior deviates from the launch behavior in that it <strong>does not</strong> inherit <code class="docutils literal"><span class="pre">extra_vars</span></code>.</p>
<p>Job relaunching does not go through the inherit logic. It uses the same <code class="docutils literal"><span class="pre">extra_vars</span></code> that were calculated for the job being relaunched.</p>
<p>For example, say that you launch a Job Template with no <code class="docutils literal"><span class="pre">extra_vars</span></code> which results in the creation of a Job called <strong>j1</strong>. Next, say that you edit the Job Template and add in some <code class="docutils literal"><span class="pre">extra_vars</span></code> (such as adding <code class="docutils literal"><span class="pre">&quot;{</span> <span class="pre">&quot;hello&quot;:</span> <span class="pre">&quot;world&quot;</span> <span class="pre">}&quot;</span></code>).</p>
<p>Relaunching <strong>j1</strong> results in the creation of <strong>j2</strong>, but because there is no inherit logic and <strong>j1</strong> had no <code class="docutils literal"><span class="pre">extra_vars</span></code>, <strong>j2</strong> will not have any <code class="docutils literal"><span class="pre">extra_vars</span></code>.</p>
<p>To continue upon this example, if you launched the Job Template with the <code class="docutils literal"><span class="pre">extra_vars</span></code> you added after the creation of <strong>j1</strong>, the relaunch job created (<strong>j3</strong>) will include the <code class="docutils literal"><span class="pre">extra_vars</span></code>. And relaunching <strong>j3</strong> results in the creation of <strong>j4</strong>, which would also include <code class="docutils literal"><span class="pre">extra_vars</span></code>.</p>
</div>
</div>
</div>


          </div>
          <div id="search-results"><gcse:searchresults-only></gcse:searchresults-only></div>
          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="job_slices.html" class="btn btn-neutral float-right" title="16. Job Slicing"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="inventories.html" class="btn btn-neutral" title="14. Inventories"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
    Copyright © 2019 Red Hat, Inc. 
    <br>
  </p>

<p>
  Red Hat Ansible Tower docs are generated using <A HREF="http://sphinx-doc.org/">Sphinx</A> using a theme provided by <a href="http://readthedocs.org">Read the Docs</a>.
</p>
</footer>
        </div>
      </div>

    </section>

  </div>
  


<!-- begin analytics -->
<script data-cfasync="false" src="email-decode.min.js"></script><script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
        (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
        n.id=i;n.src = '//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
        e.parentNode.insertBefore(n, e);
        })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->

<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
_satellite.pageBottom();
}
</script>

</body>
</html>